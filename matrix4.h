// matrix4.h -- 4 x 4 matrices
//
//  Copyright (C) 2005, 2006  Miles Bader <miles@gnu.org>
//
// This file is subject to the terms and conditions of the GNU General
// Public License.  See the file COPYING in the main directory of this
// archive for more details.
//
// Written by Miles Bader <miles@gnu.org>
//

#ifndef __MATRIX4_H__
#define __MATRIX4_H__

#include <cmath>

namespace Snogray {

template<typename T>
class Matrix4
{
public:

  static const Matrix4 identity;

  // Default constructor returns an identity matrix
  //
  Matrix4 ()
  {
    els[0][0] = 1; els[0][1] = 0; els[0][2] = 0; els[0][3] = 0;
    els[1][0] = 0; els[1][1] = 1; els[1][2] = 0; els[1][3] = 0;
    els[2][0] = 0; els[2][1] = 0; els[2][2] = 1; els[2][3] = 0;
    els[3][0] = 0; els[3][1] = 0; els[3][2] = 0; els[3][3] = 1;
  }

  T &operator() (unsigned i, unsigned j) { return els[i][j]; }
  const T &operator() (unsigned i, unsigned j) const { return els[i][j]; }

  T &el (unsigned i, unsigned j) { return els[i][j]; }
  const T &el (unsigned i, unsigned j) const { return els[i][j]; }

  Matrix4 operator* (const Matrix4 &xform) const;

  const Matrix4 &operator*= (const Matrix4 &xform)
  {
    Matrix4 temp = *this * xform;
    *this = temp;
    return *this;
  }

  Matrix4 transpose () const
  {
    Matrix4 result;
    result (0, 0) = el (0, 0); result (0, 1) = el (1, 0);
    result (0, 3) = el (3, 0); result (0, 3) = el (3, 0);
    result (1, 0) = el (0, 1); result (1, 1) = el (1, 1);
    result (1, 3) = el (3, 1); result (1, 3) = el (3, 1);
    result (2, 0) = el (0, 2); result (2, 1) = el (1, 2);
    result (2, 3) = el (3, 2); result (2, 3) = el (3, 2);
    result (3, 0) = el (0, 3); result (3, 1) = el (1, 3);
    result (3, 3) = el (3, 3); result (3, 3) = el (3, 3);
    return result;
  }

  Matrix4 inverse () const;

private:

  T els[4][4];
};

template<typename T> const Matrix4<T> Matrix4<T>::identity;

template<typename T>
Matrix4<T>
Matrix4<T>::operator* (const Matrix4<T> &xform) const
{
  Matrix4<T> result;
  for (unsigned i = 0; i < 4; i++)
    for (unsigned j = 0; j < 4; j++)
      result(i, j)
	= el (i, 0) * xform (0, j)
	+ el (i, 1) * xform (1, j)
	+ el (i, 2) * xform (2, j)
	+ el (i, 3) * xform (3, j);
  return result;
}

template<typename T>
Matrix4<T>
Matrix4<T>::inverse () const
{
  Matrix4<T> result;

  result(0, 0) =
    (1 + el(0,1)
     *(-(el(1,0) / el(0,0)) 
       - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
       *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0) 
	 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
	   - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	      + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	   *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) 
	     - el(2,0) / el(0,0)) 
	   / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
	 / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	    / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       + (el(1,3) - el(1,0)*el(0,3) / el(0,0))
       *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
     / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
     - el(0,2)
     *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0) 
       + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     + el(0,3)
     *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / el(0,0);

  result(0, 1) =
    (el(0,1)
     *(1 - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
       *((el(2,0)*el(0,1) / el(0,0) - el(2,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
	 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
	   - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	      + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	      / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))*(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
	   / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	      *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
		+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
		/ (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
	 / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	       / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       + (el(1,3) - el(1,0)*el(0,3) / el(0,0))
       *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
	 / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	    *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	      / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
     - el(0,2)
     *((el(2,0)*el(0,1) / el(0,0) - el(2,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
       + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
	 / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	    *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     + el(0,3)
     *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))*(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
       / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	  *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / el(0,0);

  result(0, 2) =
    (el(0,1)
     *((el(1,3) - el(1,0)*el(0,3) / el(0,0))
       *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	    - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
       - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
       *(1 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	 / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	      + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	      - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
		 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	      *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
		+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	      / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
		 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
     - el(0,2)
     *(1 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	    - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	      / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     + el(0,3)
     *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	  - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))) 
    / el(0,0);

  result(0, 3) =
    (el(0,1)
     *((el(1,0)*el(0,3) / el(0,0) - el(1,3)) 
       / (el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	  - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
       - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
       *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / (((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	   *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	   / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	   + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	   / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))
	  *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
     / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
     - el(0,2)
     *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     / (((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))
	*(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
     + el(0,3) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / el(0,0);

  result(1, 0) =
    (-(el(1,0) / el(0,0)) 
     - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
     *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) 
       - el(2,0) / el(0,0) 
       + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     + (el(1,3) - el(1,0)*el(0,3) / el(0,0))
     *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) 
       - el(3,0) / el(0,0) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / (el(1,1) - el(1,0)*el(0,1) / el(0,0));

  result(1, 1) =
    (1 - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
     *((el(2,0)*el(0,1) / el(0,0) - el(2,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
       + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
	 / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	    *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
       / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	     / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     + (el(1,3) - el(1,0)*el(0,3) / el(0,0))
     *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))*(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
       / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	  *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / (el(1,1) - el(1,0)*el(0,1) / el(0,0)); 

  result(1, 2) =
    ((el(1,3) - el(1,0)*el(0,3) / el(0,0))
     *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	  - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
     - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
     *(1 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	    - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	    *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	      / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
    / (el(1,1) - el(1,0)*el(0,1) / el(0,0)); 

  result(1, 3) =
    ((el(1,0)*el(0,3) / el(0,0) - el(1,3)) 
     / (el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	- (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
     - (el(1,2) - el(1,0)*el(0,2) / el(0,0))
     *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     / (((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))
	*(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) / (el(1,1) - el(1,0)*el(0,1) / el(0,0));

  result(2, 0) =
    ((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0) 
     + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
     *((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) 
       - el(3,0) / el(0,0) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(2,0) / el(0,0)) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1))); 

  result(2, 1) =
    ((el(2,0)*el(0,1) / el(0,0) - el(2,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
     + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
     *((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))*(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
       / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	  *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
     / ((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))) 
    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)));

  result(2, 2) =
    (1 + (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
     *(el(3,2) - el(3,0)*el(0,2) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
     / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	  - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	     + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	  *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	  / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))) 
    / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
       + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)));

  result(2, 3) =
    (el(2,3) - el(2,0)*el(0,3) / el(0,0) 
     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
    / (((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	*(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	/ (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	   / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) + el(3,0)*el(0,3) / el(0,0) - el(3,3) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)))
       *(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	 / (el(1,0)*el(0,1) / el(0,0) - el(1,1))));

  result(3, 0) =
    ((el(3,1) - el(3,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) - el(3,0) / el(0,0) 
     - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
     *((el(2,1) - el(2,0)*el(0,1) / el(0,0))*el(1,0) / (el(0,0)*(el(1,1) - el(1,0)*el(0,1) / el(0,0))) 
       - el(2,0) / el(0,0)) 
     / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	+ (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))) 
    / (el(3,3) - el(3,0)*el(0,3) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))); 

  result(3, 1) =
    ((el(3,0)*el(0,1) / el(0,0) - el(3,1)) / (el(1,1) - el(1,0)*el(0,1) / el(0,0)) 
     - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	+ (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
     *(el(2,0)*el(0,1) / el(0,0) - el(2,1)) 
     / ((el(1,1) - el(1,0)*el(0,1) / el(0,0))
	*(el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1))))) 
    / (el(3,3) - el(3,0)*el(0,3) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
       - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	  + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
       *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	 + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
       / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	  / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))); 

  result(3, 2) =
    -((el(3,2) - el(3,0)*el(0,2) / el(0,0) 
       + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
       / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
      / ((el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	  + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	   + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	   - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	      + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	   *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	     + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	   / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	      + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	      / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))))); 

  result(3, 3) =
    1 / (el(3,3) - el(3,0)*el(0,3) / el(0,0) 
	 + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) 
	 / (el(1,0)*el(0,1) / el(0,0) - el(1,1)) 
	 - (el(3,2) - el(3,0)*el(0,2) / el(0,0) 
	    + (el(3,1) - el(3,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1)))
	 *(el(2,3) - el(2,0)*el(0,3) / el(0,0) 
	   + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,3) - el(1,0)*el(0,3) / el(0,0)) / (el(1,0)*el(0,1) / el(0,0) - el(1,1))) 
	 / (el(2,2) - el(2,0)*el(0,2) / el(0,0) 
	    + (el(2,1) - el(2,0)*el(0,1) / el(0,0))*(el(1,2) - el(1,0)*el(0,2) / el(0,0)) 
	    / (el(1,0)*el(0,1) / el(0,0) - el(1,1))));

  return result;
}

#if 0
    result.m00 = m12*m23*m31 - m13*m22*m31 + m13*m21*m32 - m11*m23*m32 - m12*m21*m33 + m11*m22*m33;
    result.m01 = m03*m22*m31 - m02*m23*m31 - m03*m21*m32 + m01*m23*m32 + m02*m21*m33 - m01*m22*m33;
    result.m02 = m02*m13*m31 - m03*m12*m31 + m03*m11*m32 - m01*m13*m32 - m02*m11*m33 + m01*m12*m33;
    result.m03 = m03*m12*m21 - m02*m13*m21 - m03*m11*m22 + m01*m13*m22 + m02*m11*m23 - m01*m12*m23;
    result.m10 = m13*m22*m30 - m12*m23*m30 - m13*m20*m32 + m10*m23*m32 + m12*m20*m33 - m10*m22*m33;
    result.m11 = m02*m23*m30 - m03*m22*m30 + m03*m20*m32 - m00*m23*m32 - m02*m20*m33 + m00*m22*m33;
    result.m12 = m03*m12*m30 - m02*m13*m30 - m03*m10*m32 + m00*m13*m32 + m02*m10*m33 - m00*m12*m33;
    result.m13 = m02*m13*m20 - m03*m12*m20 + m03*m10*m22 - m00*m13*m22 - m02*m10*m23 + m00*m12*m23;
    result.m20 = m11*m23*m30 - m13*m21*m30 + m13*m20*m31 - m10*m23*m31 - m11*m20*m33 + m10*m21*m33;
    result.m21 = m03*m21*m30 - m01*m23*m30 - m03*m20*m31 + m00*m23*m31 + m01*m20*m33 - m00*m21*m33;
    result.m22 = m01*m13*m30 - m03*m11*m30 + m03*m10*m31 - m00*m13*m31 - m01*m10*m33 + m00*m11*m33;
    result.m23 = m03*m11*m20 - m01*m13*m20 - m03*m10*m21 + m00*m13*m21 + m01*m10*m23 - m00*m11*m23;
    result.m30 = m12*m21*m30 - m11*m22*m30 - m12*m20*m31 + m10*m22*m31 + m11*m20*m32 - m10*m21*m32;
    result.m31 = m01*m22*m30 - m02*m21*m30 + m02*m20*m31 - m00*m22*m31 - m01*m20*m32 + m00*m21*m32;
    result.m32 = m02*m11*m30 - m01*m12*m30 - m02*m10*m31 + m00*m12*m31 + m01*m10*m32 - m00*m11*m32;
    result.m33 = m01*m12*m20 - m02*m11*m20 + m02*m10*m21 - m00*m12*m21 - m01*m10*m22 + m00*m11*m22;
    scale(1/m1.determinant());
#endif

}

#endif /* __MATRIX4_H__ */

// arch-tag: f013901a-016f-4c68-b102-c5f4c7a5b4a8
